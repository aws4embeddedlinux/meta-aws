From 4f852cd6f2ef9ee638013636dfb54fa1482d8f62 Mon Sep 17 00:00:00 2001
From: Will Childs-Klein <childw@amazon.com>
Date: Tue, 15 Aug 2023 09:32:15 -0400
Subject: [PATCH] Add EVP_MD_do_all (#1154)

---
 crypto/decrepit/evp/evp_do_all.c | 7 +++++++
 include/openssl/evp.h            | 9 +++++++++
 2 files changed, 16 insertions(+)

diff --git a/crypto/decrepit/evp/evp_do_all.c b/crypto/decrepit/evp/evp_do_all.c
index 3bf8ace5c..4e550cd6e 100644
--- a/crypto/decrepit/evp/evp_do_all.c
+++ b/crypto/decrepit/evp/evp_do_all.c
@@ -91,3 +91,10 @@ void EVP_MD_do_all_sorted(void (*callback)(const EVP_MD *cipher,
   callback(EVP_sha512(), "sha512", NULL, arg);
   callback(EVP_sha512_256(), "sha512-256", NULL, arg);
 }
+
+void EVP_MD_do_all(void (*callback)(const EVP_MD *cipher,
+                                    const char *name, const char *unused,
+                                    void *arg),
+                          void *arg) {
+    EVP_MD_do_all_sorted(callback, arg);
+}
diff --git a/include/openssl/evp.h b/include/openssl/evp.h
index 99476270d..8c86b4212 100644
--- a/include/openssl/evp.h
+++ b/include/openssl/evp.h
@@ -976,6 +976,15 @@ OPENSSL_EXPORT void EVP_MD_do_all_sorted(void (*callback)(const EVP_MD *cipher,
                                                           void *arg),
                                          void *arg);
 
+// EVP_MD_do_all is the same as |EVP_MD_do_all_sorted|. We include both for
+// compatibility reasons.
+OPENSSL_EXPORT void EVP_MD_do_all(void (*callback)(const EVP_MD *cipher,
+                                                   const char *name,
+                                                   const char *unused,
+                                                   void *arg),
+                                         void *arg);
+
+
 // i2d_PrivateKey marshals a private key from |key| to type-specific format, as
 // described in |i2d_SAMPLE|.
 //
